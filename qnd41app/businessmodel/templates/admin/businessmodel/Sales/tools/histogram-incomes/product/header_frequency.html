{% load widget_tweaks %}
{% load static %}
{% load menu_tags %}




<div id="filterPopup" class="popup">
    <div class="popup-content">
        <span class="close" onclick="togglePopup()">&times;</span>
        <h1>Filter Incoms detail</h1>
        <div id="contact-form" class="custom-form" class="fl-wrap">
            <div id="message"></div>
            <fieldset>
            <form action="{% url 'businessmodel:admin_comprobante_pdf' venta_id=venta.id %}" method="GET" name="contactform" >
                <div class="form-row">
                    <div class="form-group">
                        <label for="id_fecha_inicio">Fecha Inicial</label>
                        <input type="date" id="id_fecha_inicio" name="fecha_inicio" required />
                    </div>
                    <div class="form-group">
                        <label for="id_hora_inicio">Hora Inicial</label>
                        <input type="time" id="id_hora_inicio" name="hora_inicio" required />
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="id_fecha_fin">Fecha Final</label>
                        <input type="date" id="id_fecha_fin" name="fecha_fin" required />
                    </div>
                    <div class="form-group">
                        <label for="id_hora_fin">Hora Final</label>
                        <input type="time" id="id_hora_fin" name="hora_fin" required />
                    </div>
                </div>
                <button type="submit" id="subscribe-button" class="subscribe-button"><i class="fa-brands fa-searchengin"></i>Filter</button>
            </form>
        </fieldset>
        </div>
    </div>
</div>

<header class="main-header">
    <!-- logo   -->
    
    <a href="#" class="logo-holder"><img src="{% static '/img/logo_SBA.png'%}" style="width: 174px;" alt=""></a>  
    
    <!-- search end  -->
    <a class="share-btn" href="#"><i class="fa-solid fa-cash-register"></i><span>Create a Income</span></a>
    <a href="{% url 'businessmodel:admin_comprobante_pdf' venta_id=venta.id %}" class="share-btn"><i class="fa-solid fa-eye"></i><span>Live report</span></a>
    <a class="share-btn" onclick="togglePopup()"><i class="fa-solid fa-magnifying-glass-dollar"></i><span>Filter</span></a>
    
    
   

    <div class="nav-holder main-menu">
        <nav>
            <ul>
                <li>
                    <a href="#"  class="act-link">
                        Operating Income 
                    </a>
                </li>

             
                <li>
                    <button  id="tools-button" class="tools-button">  <i class="fa-solid fa-i"></i></button>

               
                    <ul>

                        
                     
                        <li>
                            <a href="{% url 'businessmodel:informacion_venta' venta_id=venta.id %}"> 
                               Income Detail 
                              
                            </a> 

                            
                        </li>

                        <li>
                            <a href="{% url 'businessmodel:historial_ventas' venta_id=venta.id %}"> 
                            Income  History
                            </a> 
                        </li>
                     
                    </ul>
                    <!--second level end-->
                </li>

                <li>
                 
                        <button  id="tools-button" class="tools-button"> <i class="fa-solid fa-m"></i></button>
                      
               
                    <ul>
                     
                        <li>
                            <a href="{% url 'businessmodel:income_scatter' venta_id=venta.id %}"> 
                                Income Scatter
                            </a> 
                        </li>

                        <li>
                            <a href="{% url 'businessmodel:income_histogram' venta_id=venta.id %}"> 
                               Income Frequeancy
                            </a> 
                        </li>

                        <li>
                            <a href="{% url 'businessmodel:pie_incomes_time' venta_id=venta.id %}""> 
                              Income  Distribution
                            </a> 
                        </li>
                     
                    </ul>
                    <!--second level end-->
                </li>

                <li>
                    <button  id="tools-button" class="tools-button">  <i class="fa-solid fa-a"></i> </button>
               
                    <ul>
                     
                        <li>
                            <a href="#"> 
                             Income Insights
                            </a> 
                        </li>                     
                    </ul>
                    <!--second level end-->
                </li>
              
            </ul>
          
        </nav>
    </div>
    <!-- navigation  end -->  
     
     <!-- mobile nav -->
     <div class="nav-button-wrap">
        <div class="nav-button"><span></span><span></span><span></span></div>
    </div>
</header>

<script>
    function redirectToPDF(event) {
    event.preventDefault(); // Evita el envío normal del formulario

    // Obtén los valores del formulario
    const fechaInicio = document.getElementById('id_fecha_inicio').value;
    const horaInicio = document.getElementById('id_hora_inicio').value;
    const fechaFin = document.getElementById('id_fecha_fin').value;
    const horaFin = document.getElementById('id_hora_fin').value;

    // Construye la URL del PDF, ajusta según tu ruta
    const url = `{% url 'businessmodel:metricas_ventas_comprobante' venta_id=venta.id %}?fecha_inicio=${fechaInicio}&hora_inicio=${horaInicio}&fecha_fin=${fechaFin}&hora_fin=${horaFin}`;

    // Redirige a la URL construida
    window.location.href = url;
}

    function togglePopup() {
        const popup = document.getElementById("filterPopup");
        popup.style.display = popup.style.display === "block" ? "none" : "block";
    }

       // Cerrar el popup si el usuario hace clic fuera de él
    window.onclick = function(event) {
        const popup = document.getElementById("filterPopup");
        if (event.target === popup) {
            popup.style.display = "none";
        }
    }

    function toggle_reportPopup() {
        const popup = document.getElementById("reportPopup");
        popup.style.display = popup.style.display === "block" ? "none" : "block";
    }
       // Cerrar el popup si el usuario hace clic fuera de él
    window.onclick = function(event) {
        const popup = document.getElementById("reportPopup");
        if (event.target === popup) {
            popup.style.display = "none";
        }
    }
</script>